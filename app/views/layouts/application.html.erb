<!DOCTYPE html>
<html>
<head>
  <title>
    <% if @movie %>
        <%= @movie.title %>
    <% else %>
        Lovelyromcoms
    <% end %>
  </title>
  <%= stylesheet_link_tag :all %>
  <%= javascript_include_tag :defaults %>
  <%= javascript_include_tag "jquery","jquery.autocomplete" %>
  <%= csrf_meta_tag %>
</head>
<body>
<%= link_to "LOVELYROMCOMS", root_path %>
<nav>
  <% if user_signed_in? %>
      Signed in as <%= current_user.email %>
  <% else %>
      <%= link_to "Sign in", new_user_session_path %>
      <%= link_to "Sign up", new_user_registration_path %>
  <% end %>
  <%= admins_only do %>
      <%= link_to "Movie Edition", admin_movies_path %>
  <% end %>
</nav>
<p class="notice"><%= notice %></p>

<p class="alert"><%= alert %></p>

<p style="float: right;">Search: <input type="text" id="search" width="400px"/></p>

<%= yield %>

</body>
<script>
  $("#search").autocomplete({
        url: '<%= search_movies_path %>',
        showResult: function(value, data) {
            valueAndUrl = value.split(":::")
            return '<img src="'+valueAndUrl[1]+'" height="42" width="42"/><span style="color:#000000;background-color: gray; border-style: dotted">' + valueAndUrl[0] + '</span>';
        },
        onItemSelect: function(item) {
            valueAndUrl = item.value.split(":::");
            document.location.href =  '/movies/'+valueAndUrl[2]+'/edit'
        },
        displayValue:function(value,data){
          return value.split(":::")[0];
        },
        mustMatch: false,
        maxItemsToShow: 10,
        selectFirst: false,
        autoFill: true,
        selectOnly: true,
        remoteDataType: 'json'
    });
</script>
</html>
